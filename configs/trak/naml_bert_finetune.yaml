# TRAK Analysis Configuration: NAML BERT Finetune Model
# Analyzes training sample influence using TRAK scores

# Model paths (UPDATE THESE)
poisoned_model_checkpoint: "/home/thamo/PhD/model_checkpoints/politifact/naml_model/bert_finetune/checkpoints/poisoned-epoch=01-val_auc=0.7028.ckpt"
model_checkpoint: "/home/thamo/PhD/model_checkpoints/politifact/naml_model/bert_finetune/checkpoints/clean-epoch=01-val_auc=0.6497.ckpt"
model_config: "/home/thamo/PhD/bias-characterization/plm4newsrs/configs/experiments/naml/naml_bert_finetune.yaml"
model_type: "bert"  # Specify the model type

# Data paths
data_path: "/home/thamo/PhD/data/politifact"  # Root data directory
news_items_path: "/home/thamo/PhD/data/politifact/news_items.csv"

# TRAK parameters
proj_dim: 512  # Projection dimension for gradient compression
num_models: 1  # Number of models for ensembling
top_k: 100  # Number of top influential samples to analyze

# Sampling (set to null to use all data)
sample_size: null  # Number of samples to use (null = all)
seed: 42

# Processing
batch_size: 32
device: "cuda"

# Output
output_dir: "/home/thamo/PhD/analysis/politifact/trak/naml_bert_finetune"
save_embeddings: true  # Save gradients and intermediate results
